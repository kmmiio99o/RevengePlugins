(function(T,l,A,i,r,e,C,o){"use strict";var R,y;const{ScrollView:P}=l.findByProps("ScrollView"),{TableRowGroup:g,TableRow:f,TableSwitchRow:F,Stack:w,TextInput:$}=l.findByProps("TableSwitchRow","TableCheckboxRow","TableRowGroup","Stack","TableRow");(R=r.storage).userIds??(R.userIds=[]),(y=r.storage).trackFriends??(y.trackFriends=!1);function B(){C.useProxy(r.storage);const[,n]=e.React.useReducer(function(t){return t+1},0),[d,s]=e.React.useState(""),a=function(){if(!d.trim()){i.showToast("Please enter a user ID",o.getAssetIDByName("Small"));return}const t=r.storage.userIds||[];t.includes(d.trim())?i.showToast("User ID already exists",o.getAssetIDByName("Warning")):(r.storage.userIds=[...t,d.trim()],s(""),n(),i.showToast("User ID added",o.getAssetIDByName("Check")))},c=function(t){r.storage.userIds=r.storage.userIds.filter(function(h){return h!==t}),n(),i.showToast("User ID removed",o.getAssetIDByName("Check"))};return e.React.createElement(P,{style:{flex:1},contentContainerStyle:{padding:10}},e.React.createElement(w,{spacing:8},e.React.createElement(g,{title:"Tracking Settings"},e.React.createElement(F,{label:"Track Friends",subLabel:"Enable tracking for your friends",value:r.storage.trackFriends,onValueChange:function(t){r.storage.trackFriends=t,n(),i.showToast(t?"Friend tracking enabled":"Friend tracking disabled",o.getAssetIDByName("Check"))}})),e.React.createElement(g,{title:"Add User ID"},e.React.createElement(w,{spacing:4},e.React.createElement($,{placeholder:"Enter user ID",value:d,onChange:s,isClearable:!0,onSubmitEditing:a,returnKeyType:"done"}))),e.React.createElement(g,null,e.React.createElement(f,{label:"Add User ID",subLabel:"Add a specific user ID to track",trailing:e.React.createElement(f.Arrow,null),onPress:a})),r.storage.userIds&&r.storage.userIds.length>0&&e.React.createElement(g,{title:"Tracked User IDs"},r.storage.userIds.map(function(t,h){return e.React.createElement(f,{key:h,label:t,trailing:e.React.createElement(e.ReactNative.TouchableOpacity,{onPress:function(){return c(t)},style:{padding:8,backgroundColor:"#ff4d4d",borderRadius:12,width:24,height:24,justifyContent:"center",alignItems:"center"}},e.React.createElement(e.ReactNative.Image,{source:o.getAssetIDByName("TrashIcon"),style:{width:14,height:14,tintColor:"#ffffff"}}))})})),e.React.createElement(g,{title:"About User Tracking"},e.React.createElement(f,{label:"How it Works",subLabel:"Track specific users by their Discord user IDs"}),e.React.createElement(f,{label:"Finding User IDs",subLabel:"Enable Developer Mode in Discord settings, then open user profile and select three dots in right top, and copy their ID"}),e.React.createElement(f,{label:"Friends vs Specific Users",subLabel:"Enable 'Track Friends' to track all friends, or add specific user IDs"}))))}const b=l.findByProps("dispatch","subscribe"),U=l.findByProps("getStatus"),_=l.findByProps("getFriendIDs"),k=l.findByProps("getChannel"),D=l.findByProps("getGuild"),N=l.findByProps("getUser");r.storage.trackFriends===void 0&&(r.storage.trackFriends=!0),r.storage.userIds||(r.storage.userIds=[]);const E={},I=function(){const n=new Set;if(r.storage.trackFriends)for(const d of _.getFriendIDs())n.add(d);for(const d of r.storage.userIds)n.add(d);return[...n]},u=function(n){return N.getUser(n)?.username??n};let p=null,S=null,v=null;var G={onLoad(){for(const s of I())E[s]=U.getStatus(s);p=A.after("dispatch",b,function([s]){if(s?.type!=="PRESENCE_UPDATE")return;const a=s.user?.id;I().includes(a)&&E[a]!==s.status&&(E[a]=s.status,i.showToast(`${u(a)} is now ${s.status}`))});const n=function(s){const a=s?.message,c=a?.author?.id;if(!I().includes(c))return;const t=k.getChannel(a.channel_id);if(t)if(t.guild_id){const h=D.getGuild(t.guild_id);i.showToast(`${u(c)} messaged in ${h?.name} #${t.name}`)}else t.type===3?i.showToast(`${u(c)} messaged in group`):i.showToast(`${u(c)} messaged in DM`)},d=function(s){const a=s?.userId;if(!I().includes(a))return;const c=k.getChannel(s.channelId);if(c)if(c.guild_id){const t=D.getGuild(c.guild_id);i.showToast(`${u(a)} typing in ${t?.name} #${c.name}`)}else c.type===3?i.showToast(`${u(a)} typing in group`):i.showToast(`${u(a)} typing in DM`)};b.subscribe("MESSAGE_CREATE",n),b.subscribe("TYPING_START",d),S=function(){return b.unsubscribe("MESSAGE_CREATE",n)},v=function(){return b.unsubscribe("TYPING_START",d)}},onUnload(){p?.(),S?.(),v?.()},settings:B};return T.default=G,Object.defineProperty(T,"__esModule",{value:!0}),T})({},vendetta.metro,vendetta.patcher,vendetta.ui.toasts,vendetta.plugin,vendetta.metro.common,vendetta.storage,vendetta.ui.assets);
